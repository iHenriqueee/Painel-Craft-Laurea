<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LAUREA ‚Ä¢ Calculadora</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <noscript>
    <div class="noscript">
      <div class="box">
        <h2>‚ö†Ô∏è JavaScript bloqueado</h2>
        <p>Esta calculadora precisa de <b>JavaScript</b>. Se voc√™ abriu pelo preview do mensageiro, baixe e abra no navegador.</p>
        <ol>
          <li>Baixe os arquivos</li>
          <li>Abra o Opera/Chrome normalmente (n√£o an√¥nimo)</li>
          <li>Abra o link do GitHub Pages</li>
        </ol>
      </div>
    </div>
  </noscript>

  <header>
    <div class="brand">
      <<div class="logo">üëë</div>
      <div>
        <h1>LAUREA</h1>
        <small>Calculadora de craft</small>
        <div class="badge">Status: <span id="statusBar"><strong>JS</strong> ‚Ä¶</span></div>
      </div>
    </div>

    <div class="actions">
      <button id="themeToggleBtn" class="btn btn-outline" type="button">üåô Tema</button>
      <button id="adminBtn" class="btn btn-outline">üîí Admin</button>
      <button id="importBtn" class="btn btn-outline">‚¨ÜÔ∏è Importar</button>
      <button id="exportBtn" class="btn btn-outline" data-admin-only="1">‚¨áÔ∏è Exportar</button>
      <button id="resetBtn" class="btn-danger" data-admin-only="1">‚ôªÔ∏è Resetar</button>
      <input id="importFile" type="file" accept="application/json" style="display:none;" />
    </div>
  </header>

  <div class="container">
    <div class="grid">
      <div class="card">
        <h2><span class="dot"></span>Itens para Craft</h2>
        <div class="note">Selecione produtos e quantidades. Materiais e total aparecem abaixo.</div>

        <div id="listaItens"></div>

        <div class="row" style="margin-top:10px;">
          <div style="max-width:260px;">
            <button id="addItemBtn" class="btn" type="button">‚ûï Adicionar produto</button>
          </div>
          <div style="max-width:360px; text-align:right; color:var(--muted); font-size:12px;">
            Dica: o bot√£o <b>Importar</b> funciona para todos.
          </div>
        </div>
      </div>

      <div class="card">
        <h2><span class="dot"></span>Pre√ßos dos Produtos</h2>
        <div class="note">Somente admin altera pre√ßos. Usu√°rios podem importar o JSON do admin.</div>
        <div id="tabelaPrecos" class="panel"></div>
        <div class="row" style="margin-top:12px;">
          <div style="max-width:240px;">
            <button id="novoProdutoBtn" class="btn btn-outline" type="button" data-admin-only="1">‚öôÔ∏è Gerenciar produtos</button>
          </div>
        </div>
      </div>

      <div class="card">
        <h2><span class="dot"></span>Materiais Necess√°rios</h2>
        <div id="materiaisNecessarios" class="panel"></div>
      </div>

      <div class="card">
        <h2><span class="dot"></span>Resumo Financeiro</h2>
        <div class="note"><b>Desconto (%)</b> somente em caso de <b>parcerias</b>.</div>
        <div class="row" style="margin-top:10px;">
          <div style="max-width:280px;">
            <label>Desconto (%)</label>
            <input id="descontoInput" type="number" min="0" max="100" step="0.1" placeholder="0">
          </div>
        </div>
        <div id="resultadoFinanceiro" class="panel"></div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div id="modalBackdrop" class="backdrop" role="dialog" aria-modal="true">
    <div class="modal">
      <header>
        <div style="display:flex; align-items:center; justify-content:space-between; gap:12px;">
          <h3>Gerenciar produtos</h3>
          <button id="fecharModalBtn" class="btn btn-outline" type="button">‚úñ Fechar</button>
        </div>
      </header>

      <div class="split">
        <div class="panel">
          <div class="row">
            <div>
              <label>Nome do produto</label>
              <input id="nomeProduto" placeholder="Ex.: SILENCIADOR">
            </div>
            <div style="max-width:220px;">
              <label>Pre√ßo</label>
              <input id="precoProduto" type="number" min="0" step="0.01" placeholder="0">
            </div>
          </div>
          <div style="margin-top:10px;">
            <label>Receita (uma por linha: Material=Qtd)</label>
            <textarea id="receitaProduto" placeholder="Pe√ßas de Metal=10&#10;Fita Adesiva=2"></textarea>
          </div>
          <div class="row" style="margin-top:10px;">
            <div style="max-width:240px;">
              <button id="salvarProdutoBtn" class="btn" type="button">Salvar</button>
            </div>
            <div style="max-width:240px;">
              <button id="cancelarEdicaoBtn" class="btn btn-outline" type="button" style="display:none;">Cancelar</button>
            </div>
          </div>
        </div>

        <div class="panel">
          <div class="note">Lista de produtos (editar/remover)</div>
          <div id="listaProdutos" style="margin-top:10px;"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Defaults embedded (fallback if laurea-state.json missing)
    window.LAUREA_DEFAULT_RECEITAS = {
  "SILENCIADOR": {
    "Pe√ßas de Cobre": 25,
    "Garrafa Vazia": 1,
    "Fita Isolante": 1,
    "Pe√ßas de Pl√°stico": 50,
    "Fita Adesiva": 1,
    "Pasta de Dente": 2
  },
  "MIRA HOLOGR√ÅFICA": {
    "Bateria AA+": 1,
    "Pe√ßas de Vidro": 25,
    "Pe√ßas de Pl√°stico": 25,
    "Fita Adesiva": 1
  },
  "AK-103": {
    "Pe√ßas de Metal": 150,
    "Pe√ßas de Cobre": 220,
    "Pe√ßas de Vidro": 235,
    "Pe√ßas de Arma Pesada": 1,
    "Pe√ßas de Pl√°stico": 235,
    "Corpo de Rifle": 1,
    "Pe√ßas de Borracha": 235
  },
  "PENTE ESTENDIDO": {
    "Pe√ßas de Metal": 35,
    "Pe√ßas de Borracha": 50,
    "Pe√ßas de Pl√°stico": 50,
    "Fita Adesiva": 2,
    "Fita Isolante": 2
  },
  "LANTERNA T√ÅTICA": {
    "Bateria AA": 1,
    "Pe√ßas de Vidro": 25,
    "Fita Isolante": 1,
    "Pe√ßas de Pl√°stico": 25
  },
  "AK-102 (Upgrade)": {
    "AK-103": 1,
    "Pe√ßas de Metal": 75,
    "Pe√ßas de Cobre": 85,
    "Pe√ßas de Vidro": 115,
    "Pe√ßas de Arma Pesada": 1,
    "Pe√ßas de Pl√°stico": 95,
    "Pe√ßas de Borracha": 115,
    "Aperfei√ßoamento Rifle": 1
  }
};
  </script>
  <script src="app.js" defer></script>
</body>
</html>